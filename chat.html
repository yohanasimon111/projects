<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nexus AI Chat</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .cosmic-bg {
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #533483 100%);
            position: relative;
            overflow: hidden;
        }
        
        .cosmic-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.1) 0%, transparent 50%);
        }
        
        .floating-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 20s infinite linear;
        }
        
        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
        
        .glass-morphism {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .neon-glow {
            box-shadow: 0 0 20px rgba(120, 219, 255, 0.5), 0 0 40px rgba(120, 219, 255, 0.3);
        }
        
        .message-slide-in {
            animation: slideIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-50px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }
        
        .user-message-slide {
            animation: userSlide 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        @keyframes userSlide {
            from {
                opacity: 0;
                transform: translateX(50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }
        
        .pulse-ring {
            animation: pulseRing 2s infinite;
        }
        
        @keyframes pulseRing {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .typing-animation {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        .typing-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: linear-gradient(45deg, #78dbff, #ff77c6);
            animation: typingPulse 1.5s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.3s; }
        .typing-dot:nth-child(3) { animation-delay: 0.6s; }
        
        @keyframes typingPulse {
            0%, 60%, 100% { transform: scale(1); opacity: 0.7; }
            30% { transform: scale(1.4); opacity: 1; }
        }
        
        .hologram-text {
            background: linear-gradient(45deg, #78dbff, #ff77c6, #78dbff);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: hologramShift 3s ease-in-out infinite;
        }
        
        @keyframes hologramShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .send-pulse {
            transition: all 0.3s ease;
        }
        
        .send-pulse:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(120, 219, 255, 0.6);
        }
        
        .send-pulse:active {
            transform: scale(0.95);
        }
        
        .neural-network {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.1;
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(120, 219, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(255, 119, 198, 0.1) 0%, transparent 50%);
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div class="cosmic-bg h-full flex flex-col relative"><!-- Floating Particles -->
   <div class="floating-particles" id="particles"></div><!-- Neural Network Background -->
   <div class="neural-network"></div><!-- Header -->
   <header class="glass-morphism p-6 relative z-20">
    <div class="flex items-center justify-between">
     <div class="flex items-center space-x-4">
      <div class="relative">
       <div class="w-16 h-16 rounded-full bg-gradient-to-br from-blue-400 via-purple-500 to-pink-500 flex items-center justify-center pulse-ring">
        <div class="w-12 h-12 rounded-full bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center">
         <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
         </svg>
        </div>
       </div>
       <div class="absolute -top-1 -right-1 w-5 h-5 bg-green-400 rounded-full border-2 border-white animate-pulse neon-glow"></div>
      </div>
      <div>
       <h1 id="bot-name" class="text-2xl font-bold hologram-text">Nexus AI</h1>
       <p class="text-cyan-200 text-sm opacity-80">Advanced Neural Assistant</p>
       <div class="flex items-center space-x-2 mt-1">
        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div><span class="text-xs text-white/60">Neural networks active</span>
       </div>
      </div>
     </div>
     <div class="glass-morphism rounded-xl px-4 py-2">
      <div class="flex items-center space-x-2">
       <div class="w-3 h-3 bg-gradient-to-r from-green-400 to-blue-500 rounded-full animate-pulse"></div><span class="text-white/80 text-sm font-medium">ONLINE</span>
      </div>
     </div>
    </div>
   </header><!-- Chat Messages -->
   <main class="flex-1 overflow-y-auto p-6 space-y-6 relative z-10" id="chat-messages">
    <div class="flex justify-start">
     <div class="flex items-start space-x-4 max-w-4xl message-slide-in">
      <div class="w-10 h-10 rounded-full bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center flex-shrink-0">
       <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
       </svg>
      </div>
      <div class="glass-morphism rounded-2xl rounded-tl-md px-6 py-4 max-w-lg">
       <p id="welcome-message" class="text-white leading-relaxed">Welcome to Nexus AI! I'm your advanced neural assistant powered by cutting-edge AI technology. How can I assist you today?</p>
       <div class="flex items-center mt-3 text-xs text-cyan-300/70">
        <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg><span id="timestamp">Just now</span>
       </div>
      </div>
     </div>
    </div>
   </main><!-- Input Area -->
   <footer class="glass-morphism p-6 relative z-20">
    <form id="chat-form" class="flex space-x-4 mb-4">
     <div class="flex-1 relative"><input type="text" id="message-input" placeholder="Ask me anything..." class="w-full glass-morphism rounded-2xl px-6 py-4 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:border-transparent transition-all duration-300 neon-glow" autocomplete="off">
      <div class="absolute right-6 top-1/2 transform -translate-y-1/2 text-white/40 text-sm hidden" id="char-count">
       0/1000
      </div>
     </div><button type="submit" id="send-button" class="send-pulse glass-morphism rounded-2xl px-6 py-4 bg-gradient-to-r from-cyan-500 to-blue-600 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-cyan-400 disabled:opacity-50 disabled:cursor-not-allowed">
      <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
      </svg></button>
    </form><!-- Status Bar -->
    <div class="glass-morphism rounded-xl p-4">
     <div class="flex items-center justify-between">
      <div class="flex items-center space-x-3">
       <div class="w-8 h-8 rounded-full bg-gradient-to-r from-green-400 to-emerald-500 flex items-center justify-center">
        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
       </div>
       <div>
        <p class="text-white text-sm font-medium">Neural Network Active</p>
        <p class="text-white/60 text-xs">Advanced AI processing enabled</p>
       </div>
      </div>
      <div class="text-right">
       <p class="text-cyan-300 text-xs font-medium">Response Time</p>
       <p class="text-white/80 text-xs">~2-3 seconds</p>
      </div>
     </div>
    </div>
   </footer>
  </div>
  <script>
        // Configuration for Element SDK
        const defaultConfig = {
            bot_name: "Nexus AI",
            welcome_message: "Welcome to Nexus AI! I'm your advanced neural assistant powered by cutting-edge AI technology. How can I assist you today?",
            chat_theme: "Professional"
        };

        // DOM elements
        const chatMessages = document.getElementById('chat-messages');
        const messageInput = document.getElementById('message-input');
        const chatForm = document.getElementById('chat-form');
        const sendButton = document.getElementById('send-button');

        // Create floating particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            
            for (let i = 0; i < 15; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.width = particle.style.height = Math.random() * 4 + 2 + 'px';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 15) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Real AI Response System with OpenRouter API
        class NexusAI {
            constructor() {
                this.apiKey = "";
                this.endpoint = "https://openrouter.ai/api/v1/chat/completions";
                this.model = "meta-llama/llama-3.1-8b-instruct:free";
                this.conversationHistory = [];
            }

            async generateResponse(message) {
                try {
                    // Add user message to conversation history
                    this.conversationHistory.push({ role: 'user', content: message });
                    
                    // Keep only last 6 messages for context (to stay within limits)
                    if (this.conversationHistory.length > 6) {
                        this.conversationHistory = this.conversationHistory.slice(-6);
                    }

                    const requestBody = {
                        model: this.model,
                        messages: [
                            {
                                role: 'system',
                                content: 'You are Nexus AI, an advanced and helpful AI assistant. You are knowledgeable, friendly, and provide clear, concise responses. Keep responses under 200 words. Be helpful and engaging.'
                            },
                            ...this.conversationHistory
                        ],
                        max_tokens: 300,
                        temperature: 0.7,
                        stream: false
                    };

                    console.log('Sending request to OpenRouter:', requestBody);

                    const response = await fetch(this.endpoint, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${this.apiKey}`,
                            'HTTP-Referer': 'https://nexus-ai-chat.com',
                            'X-Title': 'Nexus AI Chat'
                        },
                        body: JSON.stringify(requestBody)
                    });

                    console.log('Response status:', response.status);
                    console.log('Response headers:', Object.fromEntries(response.headers.entries()));

                    if (!response.ok) {
                        const errorText = await response.text();
                        console.error('API Error Response:', errorText);
                        throw new Error(`API Error ${response.status}: ${errorText}`);
                    }

                    const data = await response.json();
                    console.log('API Response:', data);
                    
                    if (!data.choices || !data.choices[0] || !data.choices[0].message) {
                        throw new Error('Invalid response format from API');
                    }

                    const aiResponse = data.choices[0].message.content.trim();
                    
                    // Add AI response to conversation history
                    this.conversationHistory.push({ role: 'assistant', content: aiResponse });
                    
                    return {
                        success: true,
                        message: aiResponse
                    };

                } catch (error) {
                    console.error('AI API Error:', error);
                    
                    // Provide a helpful response based on the user's message
                    const lowerMessage = message.toLowerCase();
                    let smartResponse = "";
                    
                    if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                        smartResponse = "Hello! I'm Nexus AI, your advanced neural assistant. I'm here to help you with questions, explanations, creative tasks, and general conversation. What would you like to explore today?";
                    } else if (lowerMessage.includes('how are you') || lowerMessage.includes('how do you do')) {
                        smartResponse = "I'm functioning optimally! My neural networks are active and ready to assist you. I can help with a wide range of topics - from answering questions to creative problem-solving. What can I help you with?";
                    } else if (lowerMessage.includes('what can you do') || lowerMessage.includes('help me')) {
                        smartResponse = "I'm an advanced AI assistant capable of helping with many tasks: answering questions, explaining concepts, creative writing, problem-solving, coding help, analysis, and engaging conversation. What specific area interests you?";
                    } else if (lowerMessage.includes('?')) {
                        smartResponse = "That's an interesting question! While I'm experiencing some connectivity issues with my advanced systems, I'm designed to help with inquiries, explanations, creative tasks, and problem-solving. Could you rephrase your question or try a different topic?";
                    } else {
                        smartResponse = "I understand you're looking for assistance. I'm Nexus AI, equipped with advanced capabilities for helping with questions, creative tasks, explanations, and general conversation. How can I assist you today?";
                    }
                    
                    return {
                        success: false,
                        message: smartResponse,
                        error: error.message
                    };
                }
            }
        }

        const nexusAI = new NexusAI();

        // Message creation with enhanced animations
        function addMessage(content, isUser = false, showTimestamp = true) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex ${isUser ? 'justify-end' : 'justify-start'} ${isUser ? 'user-message-slide' : 'message-slide-in'}`;
            
            const messageContainer = document.createElement('div');
            messageContainer.className = `flex items-start space-x-4 max-w-4xl ${isUser ? 'flex-row-reverse space-x-reverse' : ''}`;
            
            // Avatar
            const avatar = document.createElement('div');
            avatar.className = `w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${
                isUser ? 'bg-gradient-to-br from-pink-500 to-purple-600' : 'bg-gradient-to-br from-cyan-400 to-blue-600'
            }`;
            
            const avatarIcon = document.createElement('svg');
            avatarIcon.className = 'w-5 h-5 text-white';
            avatarIcon.setAttribute('fill', 'none');
            avatarIcon.setAttribute('stroke', 'currentColor');
            avatarIcon.setAttribute('viewBox', '0 0 24 24');
            
            if (isUser) {
                avatarIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>';
            } else {
                avatarIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>';
            }
            
            avatar.appendChild(avatarIcon);
            
            // Message bubble
            const bubbleDiv = document.createElement('div');
            bubbleDiv.className = `glass-morphism rounded-2xl ${
                isUser ? 'rounded-tr-md bg-gradient-to-r from-pink-500/20 to-purple-600/20' : 'rounded-tl-md'
            } px-6 py-4 max-w-lg`;
            
            const textP = document.createElement('p');
            textP.className = 'text-white leading-relaxed';
            textP.textContent = content;
            
            bubbleDiv.appendChild(textP);
            
            if (showTimestamp) {
                const timestampDiv = document.createElement('div');
                timestampDiv.className = `flex items-center mt-3 text-xs ${isUser ? 'text-pink-300/70' : 'text-cyan-300/70'}`;
                timestampDiv.innerHTML = `
                    <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>
                `;
                bubbleDiv.appendChild(timestampDiv);
            }
            
            messageContainer.appendChild(avatar);
            messageContainer.appendChild(bubbleDiv);
            messageDiv.appendChild(messageContainer);
            chatMessages.appendChild(messageDiv);
            
            // Smooth scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Enhanced typing indicator
        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'flex justify-start message-slide-in';
            typingDiv.id = 'typing-indicator';
            
            const messageContainer = document.createElement('div');
            messageContainer.className = 'flex items-start space-x-4 max-w-4xl';
            
            const avatar = document.createElement('div');
            avatar.className = 'w-10 h-10 rounded-full bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center flex-shrink-0';
            avatar.innerHTML = '<svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>';
            
            const bubbleDiv = document.createElement('div');
            bubbleDiv.className = 'glass-morphism rounded-2xl rounded-tl-md px-6 py-4';
            
            const typingContainer = document.createElement('div');
            typingContainer.className = 'typing-animation';
            typingContainer.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
            
            bubbleDiv.appendChild(typingContainer);
            messageContainer.appendChild(avatar);
            messageContainer.appendChild(bubbleDiv);
            typingDiv.appendChild(messageContainer);
            chatMessages.appendChild(typingDiv);
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Handle form submission
        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const message = messageInput.value.trim();
            if (!message) return;
            
            // Add user message
            addMessage(message, true);
            messageInput.value = '';
            
            // Disable input while processing
            messageInput.disabled = true;
            sendButton.disabled = true;
            
            // Show typing indicator
            showTypingIndicator();
            
            try {
                // Get real AI response
                const result = await nexusAI.generateResponse(message);
                
                removeTypingIndicator();
                
                if (result.success) {
                    addMessage(result.message, false);
                } else {
                    addMessage(result.message, false);
                    console.error('AI Error:', result.error);
                }
                
            } catch (error) {
                removeTypingIndicator();
                addMessage("I'm sorry, I'm experiencing technical difficulties. Please try again in a moment.", false);
                console.error('Chat Error:', error);
            } finally {
                // Re-enable input
                messageInput.disabled = false;
                sendButton.disabled = false;
                messageInput.focus();
            }
        });

        // Character counter
        messageInput.addEventListener('input', (e) => {
            const charCount = document.getElementById('char-count');
            const length = e.target.value.length;
            charCount.textContent = `${length}/1000`;
            charCount.classList.toggle('hidden', length === 0);
            
            if (length > 900) {
                charCount.classList.add('text-red-400');
            } else {
                charCount.classList.remove('text-red-400');
            }
        });

        // Element SDK implementation
        async function onConfigChange(config) {
            const botName = config.bot_name || defaultConfig.bot_name;
            const welcomeMessage = config.welcome_message || defaultConfig.welcome_message;
            
            document.getElementById('bot-name').textContent = botName;
            document.getElementById('welcome-message').textContent = welcomeMessage;
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ['bot_name', config.bot_name || defaultConfig.bot_name],
                ['welcome_message', config.welcome_message || defaultConfig.welcome_message],
                ['chat_theme', config.chat_theme || defaultConfig.chat_theme]
            ]);
        }

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities,
                mapToEditPanelValues
            });
        }

        // Initialize
        createParticles();
        document.getElementById('timestamp').textContent = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        messageInput.focus();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'996b0b9b7742793a',t:'MTc2MTgyODcwMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>